{"cells":[{"cell_type":"markdown","source":["# Spark Revision"],"metadata":{"id":"wgwdlijda9JZ"}},{"cell_type":"markdown","source":["![image.png](data:image/png;base64,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)"],"metadata":{"id":"xzRvLOIBbE4p"}},{"cell_type":"code","source":["from pyspark.sql import SparkSession"],"metadata":{"id":"wyoxu567a-tB","executionInfo":{"status":"ok","timestamp":1750496650785,"user_tz":-330,"elapsed":814,"user":{"displayName":"UDAYPRAKASH DASARI","userId":"16282147890996278182"}}},"execution_count":1,"outputs":[]},{"cell_type":"code","source":["spark = SparkSession.builder.getOrCreate()"],"metadata":{"id":"e5Bvyf0RbGws","executionInfo":{"status":"ok","timestamp":1750496670150,"user_tz":-330,"elapsed":19368,"user":{"displayName":"UDAYPRAKASH DASARI","userId":"16282147890996278182"}}},"execution_count":2,"outputs":[]},{"cell_type":"code","source":["sc = spark.sparkContext"],"metadata":{"id":"yVygvzXpbvmR","executionInfo":{"status":"ok","timestamp":1750496670152,"user_tz":-330,"elapsed":32,"user":{"displayName":"UDAYPRAKASH DASARI","userId":"16282147890996278182"}}},"execution_count":3,"outputs":[]},{"cell_type":"markdown","source":["![image.png](data:image/png;base64,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)"],"metadata":{"id":"1q4AcDe6b5-p"}},{"cell_type":"code","source":["file_path = \"/content/drive/MyDrive/brazilion_dataset_ecommerce/gravity_books_sql_practice_100_queries.txt\"\n","df = spark.read.csv(file_path,inferSchema=True,header=True)\n","df.show(truncate=False)"],"metadata":{"colab":{"base_uri":"https://localhost:8080/"},"id":"3iOxglvVb0Y0","executionInfo":{"status":"ok","timestamp":1750496683122,"user_tz":-330,"elapsed":12975,"user":{"displayName":"UDAYPRAKASH DASARI","userId":"16282147890996278182"}},"outputId":"72106494-f984-4a34-8e78-f667ef412694"},"execution_count":4,"outputs":[{"output_type":"stream","name":"stdout","text":["+-----------------------------------------------------------+\n","|gravity_books - 100 SQL Queries for Data Engineer Practice |\n","+-----------------------------------------------------------+\n","|===========================================================|\n","|Phase 1: Basic Queries (1–20)                              |\n","|-----------------------------                              |\n","|1. Get all authors' names.                                 |\n","|select author_name from author;                            |\n","|2. List all books with more than 300 pages.                |\n","|select title from book                                     |\n","|where num_pages > 300;                                     |\n","|3. Find all books published after 2010.                    |\n","|select title from book                                     |\n","|where year(publication_date) > '2010';                     |\n","|4. Get the first 5 publishers sorted alphabetically.       |\n","|select publisher_name from publisher                       |\n","|order by publisher_name;                                   |\n","|5. List distinct languages used in books.                  |\n","|select distinct language_name from book_language;          |\n","|6. Show email IDs of all customers.                        |\n","|select distinct email from customer;                       |\n","|7. Find customers whose first name starts with \"A\".        |\n","|select first_name from customer                            |\n","+-----------------------------------------------------------+\n","only showing top 20 rows\n","\n"]}]},{"cell_type":"markdown","source":["![image.png](data:image/png;base64,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)"],"metadata":{"id":"3ynN6SpccrjG"}},{"cell_type":"code","source":["df.write.csv(\"/content/output/sample_data/gravity.csv\")"],"metadata":{"id":"94hKChoxb7cE","executionInfo":{"status":"ok","timestamp":1750496684322,"user_tz":-330,"elapsed":1198,"user":{"displayName":"UDAYPRAKASH DASARI","userId":"16282147890996278182"}}},"execution_count":5,"outputs":[]},{"cell_type":"code","source":["df.write.json(\"/content/output/sample_data/gravity.json\")"],"metadata":{"id":"F0qNx-Hcb6hq","executionInfo":{"status":"ok","timestamp":1750496685005,"user_tz":-330,"elapsed":676,"user":{"displayName":"UDAYPRAKASH DASARI","userId":"16282147890996278182"}}},"execution_count":6,"outputs":[]},{"cell_type":"code","source":["df.write.parquet(\"/content/output/sample_data/gravity.parquet\")"],"metadata":{"id":"XH_EA3gqdgNI","executionInfo":{"status":"ok","timestamp":1750496686549,"user_tz":-330,"elapsed":1542,"user":{"displayName":"UDAYPRAKASH DASARI","userId":"16282147890996278182"}}},"execution_count":7,"outputs":[]},{"cell_type":"markdown","source":["![image.png](data:image/png;base64,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)"],"metadata":{"id":"7G8Fq4YhdxZj"}},{"cell_type":"code","source":["df.na.fill(\"Unknown\").show(truncate=False)"],"metadata":{"colab":{"base_uri":"https://localhost:8080/"},"id":"wE7HVRSddpCL","executionInfo":{"status":"ok","timestamp":1750496686912,"user_tz":-330,"elapsed":357,"user":{"displayName":"UDAYPRAKASH DASARI","userId":"16282147890996278182"}},"outputId":"f9989ca5-55e3-4bb0-97e7-c444c1a09f8d"},"execution_count":8,"outputs":[{"output_type":"stream","name":"stdout","text":["+-----------------------------------------------------------+\n","|gravity_books - 100 SQL Queries for Data Engineer Practice |\n","+-----------------------------------------------------------+\n","|===========================================================|\n","|Phase 1: Basic Queries (1–20)                              |\n","|-----------------------------                              |\n","|1. Get all authors' names.                                 |\n","|select author_name from author;                            |\n","|2. List all books with more than 300 pages.                |\n","|select title from book                                     |\n","|where num_pages > 300;                                     |\n","|3. Find all books published after 2010.                    |\n","|select title from book                                     |\n","|where year(publication_date) > '2010';                     |\n","|4. Get the first 5 publishers sorted alphabetically.       |\n","|select publisher_name from publisher                       |\n","|order by publisher_name;                                   |\n","|5. List distinct languages used in books.                  |\n","|select distinct language_name from book_language;          |\n","|6. Show email IDs of all customers.                        |\n","|select distinct email from customer;                       |\n","|7. Find customers whose first name starts with \"A\".        |\n","|select first_name from customer                            |\n","+-----------------------------------------------------------+\n","only showing top 20 rows\n","\n"]}]},{"cell_type":"code","source":["df.dropDuplicates().show(truncate=False)"],"metadata":{"colab":{"base_uri":"https://localhost:8080/"},"id":"uXcTM0Y-dyDd","executionInfo":{"status":"ok","timestamp":1750496688580,"user_tz":-330,"elapsed":1666,"user":{"displayName":"UDAYPRAKASH DASARI","userId":"16282147890996278182"}},"outputId":"721a3b76-a8c4-4df0-8a54-8a5708e6efa2"},"execution_count":9,"outputs":[{"output_type":"stream","name":"stdout","text":["+----------------------------------------------------------+\n","|gravity_books - 100 SQL Queries for Data Engineer Practice|\n","+----------------------------------------------------------+\n","|16. Get top 10 customers by ID.                           |\n","|where publisher_name <> 'Penguin';                        |\n","|inner join address a                                      |\n","|where year(publication_date) > '2010';                    |\n","|    -> inner join order_line ol                           |\n","|select count(author_id) as total_authors from author;     |\n","|inner join book_author ba                                 |\n","|select cy.country_name                                    |\n","|2. List all books with more than 300 pages.               |\n","|on b.publisher_id = p.publisher_id                        |\n","|33. List the most recent order for each customer.         |\n","|group by order_id;                                        |\n","|select b.title                                            |\n","|86. Calculate LTV (lifetime value) of each customer.      |\n","|22. List number of books by each language.                |\n","|28. List books that were never ordered.                   |\n","|select distinct email from customer;                      |\n","|left join order_history oh                                |\n","|group by c.customer_id                                    |\n","|93. Find the book with maximum price variance.            |\n","+----------------------------------------------------------+\n","only showing top 20 rows\n","\n"]}]},{"cell_type":"markdown","source":["![image.png](data:image/png;base64,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)"],"metadata":{"id":"yvlCd5DTeoXy"}},{"cell_type":"code","source":["from pyspark.sql.functions import when, col"],"metadata":{"id":"xBYPz4wHeo8I","executionInfo":{"status":"ok","timestamp":1750496688595,"user_tz":-330,"elapsed":12,"user":{"displayName":"UDAYPRAKASH DASARI","userId":"16282147890996278182"}}},"execution_count":10,"outputs":[]},{"cell_type":"code","source":["df_1 = spark.read.csv(\"/content/drive/MyDrive/brazilion_dataset_ecommerce/olist_customers_dataset.csv\",header=True)"],"metadata":{"id":"hfibSNoMedFb","executionInfo":{"status":"ok","timestamp":1750496689534,"user_tz":-330,"elapsed":932,"user":{"displayName":"UDAYPRAKASH DASARI","userId":"16282147890996278182"}}},"execution_count":11,"outputs":[]},{"cell_type":"code","source":["df_1.show(truncate=False)"],"metadata":{"colab":{"base_uri":"https://localhost:8080/"},"id":"yRqMfePFe3QJ","executionInfo":{"status":"ok","timestamp":1750496689990,"user_tz":-330,"elapsed":451,"user":{"displayName":"UDAYPRAKASH DASARI","userId":"16282147890996278182"}},"outputId":"e841b5d4-4bf6-4aad-bcca-db4fea801619"},"execution_count":12,"outputs":[{"output_type":"stream","name":"stdout","text":["+--------------------------------+--------------------------------+------------------------+---------------------+--------------+\n","|customer_id                     |customer_unique_id              |customer_zip_code_prefix|customer_city        |customer_state|\n","+--------------------------------+--------------------------------+------------------------+---------------------+--------------+\n","|06b8999e2fba1a1fbc88172c00ba8bc7|861eff4711a542e4b93843c6dd7febb0|14409                   |franca               |SP            |\n","|18955e83d337fd6b2def6b18a428ac77|290c77bc529b7ac935b93aa66c333dc3|09790                   |sao bernardo do campo|SP            |\n","|4e7b3e00288586ebd08712fdd0374a03|060e732b5b29e8181a18229c7b0b2b5e|01151                   |sao paulo            |SP            |\n","|b2b6027bc5c5109e529d4dc6358b12c3|259dac757896d24d7702b9acbbff3f3c|08775                   |mogi das cruzes      |SP            |\n","|4f2d8ab171c80ec8364f7c12e35b23ad|345ecd01c38d18a9036ed96c73b8d066|13056                   |campinas             |SP            |\n","|879864dab9bc3047522c92c82e1212b8|4c93744516667ad3b8f1fb645a3116a4|89254                   |jaragua do sul       |SC            |\n","|fd826e7cf63160e536e0908c76c3f441|addec96d2e059c80c30fe6871d30d177|04534                   |sao paulo            |SP            |\n","|5e274e7a0c3809e14aba7ad5aae0d407|57b2a98a409812fe9618067b6b8ebe4f|35182                   |timoteo              |MG            |\n","|5adf08e34b2e993982a47070956c5c65|1175e95fb47ddff9de6b2b06188f7e0d|81560                   |curitiba             |PR            |\n","|4b7139f34592b3a31687243a302fa75b|9afe194fb833f79e300e37e580171f22|30575                   |belo horizonte       |MG            |\n","|9fb35e4ed6f0a14a4977cd9aea4042bb|2a7745e1ed516b289ed9b29c7d0539a5|39400                   |montes claros        |MG            |\n","|5aa9e4fdd4dfd20959cad2d772509598|2a46fb94aef5cbeeb850418118cee090|20231                   |rio de janeiro       |RJ            |\n","|b2d1536598b73a9abd18e0d75d92f0a3|918dc87cd72cd9f6ed4bd442ed785235|18682                   |lencois paulista     |SP            |\n","|eabebad39a88bb6f5b52376faec28612|295c05e81917928d76245e842748184d|05704                   |sao paulo            |SP            |\n","|1f1c7bf1c9b041b292af6c1c4470b753|3151a81801c8386361b62277d7fa5ecf|95110                   |caxias do sul        |RS            |\n","|206f3129c0e4d7d0b9550426023f0a08|21f748a16f4e1688a9014eb3ee6fa325|13412                   |piracicaba           |SP            |\n","|a7c125a0a07b75146167b7f04a7f8e98|5c2991dbd08bbf3cf410713c4de5a0b5|22750                   |rio de janeiro       |RJ            |\n","|c5c61596a3b6bd0cee5766992c48a9a1|b6e99561fe6f34a55b0b7da92f8ed775|07124                   |guarulhos            |SP            |\n","|9b8ce803689b3562defaad4613ef426f|7f3a72e8f988c6e735ba118d54f47458|05416                   |sao paulo            |SP            |\n","|49d0ea0986edde72da777f15456a0ee0|3e6fd6b2f0d499456a6a6820a40f2d79|68485                   |pacaja               |PA            |\n","+--------------------------------+--------------------------------+------------------------+---------------------+--------------+\n","only showing top 20 rows\n","\n"]}]},{"cell_type":"code","source":["df_1 = df_1.withColumn(\"Full_State_Name\", when(col(\"customer_state\")== \"SP\", \"South_State\"))"],"metadata":{"id":"MPuAVQo4gcHP","executionInfo":{"status":"ok","timestamp":1750496690092,"user_tz":-330,"elapsed":100,"user":{"displayName":"UDAYPRAKASH DASARI","userId":"16282147890996278182"}}},"execution_count":13,"outputs":[]},{"cell_type":"code","source":["df_1.show()"],"metadata":{"colab":{"base_uri":"https://localhost:8080/"},"id":"wdc1yVncgrwp","executionInfo":{"status":"ok","timestamp":1750496690562,"user_tz":-330,"elapsed":461,"user":{"displayName":"UDAYPRAKASH DASARI","userId":"16282147890996278182"}},"outputId":"88595336-1c05-4a8b-854a-d997a40534d5"},"execution_count":14,"outputs":[{"output_type":"stream","name":"stdout","text":["+--------------------+--------------------+------------------------+--------------------+--------------+---------------+\n","|         customer_id|  customer_unique_id|customer_zip_code_prefix|       customer_city|customer_state|Full_State_Name|\n","+--------------------+--------------------+------------------------+--------------------+--------------+---------------+\n","|06b8999e2fba1a1fb...|861eff4711a542e4b...|                   14409|              franca|            SP|    South_State|\n","|18955e83d337fd6b2...|290c77bc529b7ac93...|                   09790|sao bernardo do c...|            SP|    South_State|\n","|4e7b3e00288586ebd...|060e732b5b29e8181...|                   01151|           sao paulo|            SP|    South_State|\n","|b2b6027bc5c5109e5...|259dac757896d24d7...|                   08775|     mogi das cruzes|            SP|    South_State|\n","|4f2d8ab171c80ec83...|345ecd01c38d18a90...|                   13056|            campinas|            SP|    South_State|\n","|879864dab9bc30475...|4c93744516667ad3b...|                   89254|      jaragua do sul|            SC|           NULL|\n","|fd826e7cf63160e53...|addec96d2e059c80c...|                   04534|           sao paulo|            SP|    South_State|\n","|5e274e7a0c3809e14...|57b2a98a409812fe9...|                   35182|             timoteo|            MG|           NULL|\n","|5adf08e34b2e99398...|1175e95fb47ddff9d...|                   81560|            curitiba|            PR|           NULL|\n","|4b7139f34592b3a31...|9afe194fb833f79e3...|                   30575|      belo horizonte|            MG|           NULL|\n","|9fb35e4ed6f0a14a4...|2a7745e1ed516b289...|                   39400|       montes claros|            MG|           NULL|\n","|5aa9e4fdd4dfd2095...|2a46fb94aef5cbeeb...|                   20231|      rio de janeiro|            RJ|           NULL|\n","|b2d1536598b73a9ab...|918dc87cd72cd9f6e...|                   18682|    lencois paulista|            SP|    South_State|\n","|eabebad39a88bb6f5...|295c05e81917928d7...|                   05704|           sao paulo|            SP|    South_State|\n","|1f1c7bf1c9b041b29...|3151a81801c838636...|                   95110|       caxias do sul|            RS|           NULL|\n","|206f3129c0e4d7d0b...|21f748a16f4e1688a...|                   13412|          piracicaba|            SP|    South_State|\n","|a7c125a0a07b75146...|5c2991dbd08bbf3cf...|                   22750|      rio de janeiro|            RJ|           NULL|\n","|c5c61596a3b6bd0ce...|b6e99561fe6f34a55...|                   07124|           guarulhos|            SP|    South_State|\n","|9b8ce803689b3562d...|7f3a72e8f988c6e73...|                   05416|           sao paulo|            SP|    South_State|\n","|49d0ea0986edde72d...|3e6fd6b2f0d499456...|                   68485|              pacaja|            PA|           NULL|\n","+--------------------+--------------------+------------------------+--------------------+--------------+---------------+\n","only showing top 20 rows\n","\n"]}]},{"cell_type":"markdown","source":["# Creating Empy RDD"],"metadata":{"id":"7mkAP5AzjA4w"}},{"cell_type":"code","source":["emptyrdd = sc.emptyRDD()"],"metadata":{"id":"RJiqO-mMjErL","executionInfo":{"status":"ok","timestamp":1750496690579,"user_tz":-330,"elapsed":14,"user":{"displayName":"UDAYPRAKASH DASARI","userId":"16282147890996278182"}}},"execution_count":15,"outputs":[]},{"cell_type":"code","source":["for i in emptyrdd.collect():\n","  print(i)"],"metadata":{"id":"xrr9QYj7iXSV","executionInfo":{"status":"ok","timestamp":1750496690642,"user_tz":-330,"elapsed":59,"user":{"displayName":"UDAYPRAKASH DASARI","userId":"16282147890996278182"}}},"execution_count":16,"outputs":[]},{"cell_type":"markdown","source":["# Creating A RDD"],"metadata":{"id":"okxtn3PjjXyN"}},{"cell_type":"code","source":["data = [1,2,3,4,5,6,7,8,9,]\n","rdd = sc.parallelize(data)"],"metadata":{"id":"cXBD50BOjDbG","executionInfo":{"status":"ok","timestamp":1750496690659,"user_tz":-330,"elapsed":14,"user":{"displayName":"UDAYPRAKASH DASARI","userId":"16282147890996278182"}}},"execution_count":17,"outputs":[]},{"cell_type":"code","source":["for i in rdd.collect():\n","  print(i)"],"metadata":{"colab":{"base_uri":"https://localhost:8080/"},"id":"BBnHAq86jZ2-","executionInfo":{"status":"ok","timestamp":1750496690741,"user_tz":-330,"elapsed":78,"user":{"displayName":"UDAYPRAKASH DASARI","userId":"16282147890996278182"}},"outputId":"dcb3b6af-60da-4ba6-e50b-d24c1cc345ed"},"execution_count":18,"outputs":[{"output_type":"stream","name":"stdout","text":["1\n","2\n","3\n","4\n","5\n","6\n","7\n","8\n","9\n"]}]},{"cell_type":"markdown","source":["# Repartitioning"],"metadata":{"id":"Axx9GGQMjvFI"}},{"cell_type":"code","source":["rdd = sc.parallelize(data,10)\n","rdd1 = rdd.repartition(4)"],"metadata":{"id":"0gQNNYN_jxi2","executionInfo":{"status":"ok","timestamp":1750496690802,"user_tz":-330,"elapsed":55,"user":{"displayName":"UDAYPRAKASH DASARI","userId":"16282147890996278182"}}},"execution_count":19,"outputs":[]},{"cell_type":"code","source":["print(\"Count of Partitions:\"+str(rdd.getNumPartitions()))\n","print(\"Coint of Partitions:\"+str(rdd1.getNumPartitions()))"],"metadata":{"colab":{"base_uri":"https://localhost:8080/"},"id":"SeCj82Pjj__o","executionInfo":{"status":"ok","timestamp":1750496690854,"user_tz":-330,"elapsed":49,"user":{"displayName":"UDAYPRAKASH DASARI","userId":"16282147890996278182"}},"outputId":"f76c670d-1fbe-41e1-d5df-7276c228a06d"},"execution_count":20,"outputs":[{"output_type":"stream","name":"stdout","text":["Count of Partitions:10\n","Coint of Partitions:4\n"]}]},{"cell_type":"markdown","source":["# Loading TextFile"],"metadata":{"id":"NOFaar4ukejf"}},{"cell_type":"code","source":["df_text = spark.read.text(\"/content/drive/MyDrive/brazilion_dataset_ecommerce/gravity_books_sql_practice_100_queries.txt\")"],"metadata":{"id":"ZiqZNMjZkOqy","executionInfo":{"status":"ok","timestamp":1750496690895,"user_tz":-330,"elapsed":44,"user":{"displayName":"UDAYPRAKASH DASARI","userId":"16282147890996278182"}}},"execution_count":21,"outputs":[]},{"cell_type":"code","source":["df_text.show(truncate=False)"],"metadata":{"colab":{"base_uri":"https://localhost:8080/"},"id":"UWUTdfDtke9j","executionInfo":{"status":"ok","timestamp":1750496691231,"user_tz":-330,"elapsed":338,"user":{"displayName":"UDAYPRAKASH DASARI","userId":"16282147890996278182"}},"outputId":"eeba385f-4f8b-46a6-83ea-e4752e1c9a8a"},"execution_count":22,"outputs":[{"output_type":"stream","name":"stdout","text":["+-----------------------------------------------------------+\n","|value                                                      |\n","+-----------------------------------------------------------+\n","|                                                           |\n","|gravity_books - 100 SQL Queries for Data Engineer Practice |\n","|===========================================================|\n","|                                                           |\n","|Phase 1: Basic Queries (1–20)                              |\n","|-----------------------------                              |\n","|1. Get all authors' names.                                 |\n","|select author_name from author;                            |\n","|                                                           |\n","|2. List all books with more than 300 pages.                |\n","|select title from book                                     |\n","|where num_pages > 300;                                     |\n","|                                                           |\n","|3. Find all books published after 2010.                    |\n","|select title from book                                     |\n","|where year(publication_date) > '2010';                     |\n","|                                                           |\n","|                                                           |\n","|4. Get the first 5 publishers sorted alphabetically.       |\n","|select publisher_name from publisher                       |\n","+-----------------------------------------------------------+\n","only showing top 20 rows\n","\n"]}]},{"cell_type":"markdown","source":["# Map And FlatMap"],"metadata":{"id":"4NqBD3_IlA8w"}},{"cell_type":"code","source":["rdd2 = rdd.map(lambda x:(x,10))\n","for i in rdd2.collect():\n","  print(i)"],"metadata":{"colab":{"base_uri":"https://localhost:8080/"},"id":"bQV3_VLrku3W","executionInfo":{"status":"ok","timestamp":1750496694356,"user_tz":-330,"elapsed":3101,"user":{"displayName":"UDAYPRAKASH DASARI","userId":"16282147890996278182"}},"outputId":"7d2c8078-8eb6-4583-8740-af5979d1de42"},"execution_count":23,"outputs":[{"output_type":"stream","name":"stdout","text":["(1, 10)\n","(2, 10)\n","(3, 10)\n","(4, 10)\n","(5, 10)\n","(6, 10)\n","(7, 10)\n","(8, 10)\n","(9, 10)\n"]}]},{"cell_type":"code","source":["rdd3 = df_text.flatMap(lambda x: x.split(','))\n","for i in rdd3.collect():\n","  print(i)"],"metadata":{"colab":{"base_uri":"https://localhost:8080/","height":297},"id":"28gUB2BBlF2v","executionInfo":{"status":"error","timestamp":1750496846792,"user_tz":-330,"elapsed":24,"user":{"displayName":"UDAYPRAKASH DASARI","userId":"16282147890996278182"}},"outputId":"68b4bff3-e9db-4459-c3ef-dd4eecddc84f"},"execution_count":25,"outputs":[{"output_type":"error","ename":"AttributeError","evalue":"'DataFrame' object has no attribute 'flatMap'","traceback":["\u001b[0;31m---------------------------------------------------------------------------\u001b[0m","\u001b[0;31mAttributeError\u001b[0m                            Traceback (most recent call last)","\u001b[0;32m/tmp/ipython-input-25-2204196563.py\u001b[0m in \u001b[0;36m<cell line: 0>\u001b[0;34m()\u001b[0m\n\u001b[0;32m----> 1\u001b[0;31m \u001b[0mrdd3\u001b[0m \u001b[0;34m=\u001b[0m \u001b[0mdf_text\u001b[0m\u001b[0;34m.\u001b[0m\u001b[0mflatMap\u001b[0m\u001b[0;34m(\u001b[0m\u001b[0;32mlambda\u001b[0m \u001b[0mx\u001b[0m\u001b[0;34m:\u001b[0m \u001b[0mx\u001b[0m\u001b[0;34m.\u001b[0m\u001b[0msplit\u001b[0m\u001b[0;34m(\u001b[0m\u001b[0;34m','\u001b[0m\u001b[0;34m)\u001b[0m\u001b[0;34m)\u001b[0m\u001b[0;34m\u001b[0m\u001b[0;34m\u001b[0m\u001b[0m\n\u001b[0m\u001b[1;32m      2\u001b[0m \u001b[0;32mfor\u001b[0m \u001b[0mi\u001b[0m \u001b[0;32min\u001b[0m \u001b[0mrdd3\u001b[0m\u001b[0;34m.\u001b[0m\u001b[0mcollect\u001b[0m\u001b[0;34m(\u001b[0m\u001b[0;34m)\u001b[0m\u001b[0;34m:\u001b[0m\u001b[0;34m\u001b[0m\u001b[0;34m\u001b[0m\u001b[0m\n\u001b[1;32m      3\u001b[0m   \u001b[0mprint\u001b[0m\u001b[0;34m(\u001b[0m\u001b[0mi\u001b[0m\u001b[0;34m)\u001b[0m\u001b[0;34m\u001b[0m\u001b[0;34m\u001b[0m\u001b[0m\n","\u001b[0;32m/usr/local/lib/python3.11/dist-packages/pyspark/sql/dataframe.py\u001b[0m in \u001b[0;36m__getattr__\u001b[0;34m(self, name)\u001b[0m\n\u001b[1;32m   3125\u001b[0m         \"\"\"\n\u001b[1;32m   3126\u001b[0m         \u001b[0;32mif\u001b[0m \u001b[0mname\u001b[0m \u001b[0;32mnot\u001b[0m \u001b[0;32min\u001b[0m \u001b[0mself\u001b[0m\u001b[0;34m.\u001b[0m\u001b[0mcolumns\u001b[0m\u001b[0;34m:\u001b[0m\u001b[0;34m\u001b[0m\u001b[0;34m\u001b[0m\u001b[0m\n\u001b[0;32m-> 3127\u001b[0;31m             raise AttributeError(\n\u001b[0m\u001b[1;32m   3128\u001b[0m                 \u001b[0;34m\"'%s' object has no attribute '%s'\"\u001b[0m \u001b[0;34m%\u001b[0m \u001b[0;34m(\u001b[0m\u001b[0mself\u001b[0m\u001b[0;34m.\u001b[0m\u001b[0m__class__\u001b[0m\u001b[0;34m.\u001b[0m\u001b[0m__name__\u001b[0m\u001b[0;34m,\u001b[0m \u001b[0mname\u001b[0m\u001b[0;34m)\u001b[0m\u001b[0;34m\u001b[0m\u001b[0;34m\u001b[0m\u001b[0m\n\u001b[1;32m   3129\u001b[0m             )\n","\u001b[0;31mAttributeError\u001b[0m: 'DataFrame' object has no attribute 'flatMap'"]}]},{"cell_type":"code","source":["import pyspark\n","from pyspark.sql import SparkSession\n","from pyspark.sql.functions import expr\n","spark = SparkSession.builder.appName('SparkByExamples.com').getOrCreate()"],"metadata":{"id":"HgvYynyulflI","executionInfo":{"status":"ok","timestamp":1750496852676,"user_tz":-330,"elapsed":15,"user":{"displayName":"UDAYPRAKASH DASARI","userId":"16282147890996278182"}}},"execution_count":26,"outputs":[]},{"cell_type":"code","source":["data = [(\"Banana\",1000,\"USA\"), (\"Carrots\",1500,\"USA\"), (\"Beans\",1600,\"USA\"), \\\n","      (\"Orange\",2000,\"USA\"),(\"Orange\",2000,\"USA\"),(\"Banana\",400,\"China\"), \\\n","      (\"Carrots\",1200,\"China\"),(\"Beans\",1500,\"China\"),(\"Orange\",4000,\"China\"), \\\n","      (\"Banana\",2000,\"Canada\"),(\"Carrots\",2000,\"Canada\"),(\"Beans\",2000,\"Mexico\")]"],"metadata":{"id":"58JMVUqipiG_","executionInfo":{"status":"ok","timestamp":1750496855403,"user_tz":-330,"elapsed":2,"user":{"displayName":"UDAYPRAKASH DASARI","userId":"16282147890996278182"}}},"execution_count":27,"outputs":[]},{"cell_type":"code","source":["columns= [\"Product\",\"Amount\",\"Country\"]\n","df = spark.createDataFrame(data = data, schema = columns)\n","df.printSchema()\n","df.show(truncate=False)"],"metadata":{"id":"1TN47XNppiFG","executionInfo":{"status":"ok","timestamp":1750496858997,"user_tz":-330,"elapsed":1884,"user":{"displayName":"UDAYPRAKASH DASARI","userId":"16282147890996278182"}},"colab":{"base_uri":"https://localhost:8080/"},"outputId":"a974423e-b418-4fbd-e242-4b6a7a2db1a5"},"execution_count":28,"outputs":[{"output_type":"stream","name":"stdout","text":["root\n"," |-- Product: string (nullable = true)\n"," |-- Amount: long (nullable = true)\n"," |-- Country: string (nullable = true)\n","\n","+-------+------+-------+\n","|Product|Amount|Country|\n","+-------+------+-------+\n","|Banana |1000  |USA    |\n","|Carrots|1500  |USA    |\n","|Beans  |1600  |USA    |\n","|Orange |2000  |USA    |\n","|Orange |2000  |USA    |\n","|Banana |400   |China  |\n","|Carrots|1200  |China  |\n","|Beans  |1500  |China  |\n","|Orange |4000  |China  |\n","|Banana |2000  |Canada |\n","|Carrots|2000  |Canada |\n","|Beans  |2000  |Mexico |\n","+-------+------+-------+\n","\n"]}]},{"cell_type":"code","source":["pivotDF = df.groupBy(\"Product\").pivot(\"Country\").sum(\"Amount\")\n","pivotDF.printSchema()\n","pivotDF.show(truncate=False)"],"metadata":{"id":"rMdT7y5TpiB0","executionInfo":{"status":"aborted","timestamp":1750496694841,"user_tz":-330,"elapsed":45111,"user":{"displayName":"UDAYPRAKASH DASARI","userId":"16282147890996278182"}}},"execution_count":null,"outputs":[]},{"cell_type":"code","source":["pivotDF = df.groupBy(\"Product\", \"Country\") \\\n","            .sum(\"Amount\") \\\n","            .groupBy(\"Product\") \\\n","            .pivot(\"country\") \\\n","            .sum(\"sum(amount)\")\n","pivotDF.printSchema()\n","pivotDF.show()"],"metadata":{"id":"BcHSDpfwph_y","executionInfo":{"status":"aborted","timestamp":1750496694844,"user_tz":-330,"elapsed":45114,"user":{"displayName":"UDAYPRAKASH DASARI","userId":"16282147890996278182"}}},"execution_count":null,"outputs":[]},{"cell_type":"code","source":["unpicotExpr = \"stack(4, 'Canada', Canada,'China', China, 'Mexico',Mexico,'USA',USA) as (country,Total)\"\n","unPivotDF = pivotDF.select(\"Product\", expr(unpicotExpr)) \\\n","    .where(\"Total is not null\")\n","unPivotDF.show(truncate=False)"],"metadata":{"id":"ykN8nCFeph7b","executionInfo":{"status":"aborted","timestamp":1750496694846,"user_tz":-330,"elapsed":45116,"user":{"displayName":"UDAYPRAKASH DASARI","userId":"16282147890996278182"}}},"execution_count":null,"outputs":[]},{"cell_type":"code","source":["unpicotExpr = \"stack(4, 'Canada', Canada,'China', China, 'Mexico',Mexico,'USA',USA) as (country,Total)\"\n","unPivotDF = pivotDF.select(\"Product\", expr(unpicotExpr))\n","unPivotDF.show(truncate=False)"],"metadata":{"id":"yDrIFn5zph5J","executionInfo":{"status":"aborted","timestamp":1750496694847,"user_tz":-330,"elapsed":45117,"user":{"displayName":"UDAYPRAKASH DASARI","userId":"16282147890996278182"}}},"execution_count":null,"outputs":[]},{"cell_type":"code","source":["from pyspark.sql import SparkSession\n","spark = SparkSession.builder.getOrCreate()"],"metadata":{"id":"eGlYO1_gph3Q","executionInfo":{"status":"aborted","timestamp":1750496694850,"user_tz":-330,"elapsed":45119,"user":{"displayName":"UDAYPRAKASH DASARI","userId":"16282147890996278182"}}},"execution_count":null,"outputs":[]},{"cell_type":"code","source":["from pyspark.sql.functions import col\n","\n","data=[(\"2019-01-23\",1),(\"2019-06-24\",2),(\"2019-09-20\",3)]\n","from pyspark.sql.functions import col, expr, to_date\n","\n","data=[(\"2019-01-23\",1),(\"2019-06-24\",2),(\"2019-09-20\",3)]\n","\n","spark.createDataFrame(data).toDF(\"date\",\"increment\")\\\n","     .select(col(\"date\"),col(\"increment\"), \\\n","     expr(\"add_months(to_date(date,'yyyy-MM-dd'),cast(increment as int))\").alias(\"inc_date\")) \\\n","     .show()"],"metadata":{"id":"Cr82ezmhph0a","executionInfo":{"status":"aborted","timestamp":1750496694855,"user_tz":-330,"elapsed":45124,"user":{"displayName":"UDAYPRAKASH DASARI","userId":"16282147890996278182"}}},"execution_count":null,"outputs":[]},{"cell_type":"code","source":[],"metadata":{"id":"z5IP4R1Xphw2","executionInfo":{"status":"aborted","timestamp":1750496694865,"user_tz":-330,"elapsed":45133,"user":{"displayName":"UDAYPRAKASH DASARI","userId":"16282147890996278182"}}},"execution_count":null,"outputs":[]},{"cell_type":"code","source":[],"metadata":{"id":"PvNuGBQnqK1R","executionInfo":{"status":"aborted","timestamp":1750496694873,"user_tz":-330,"elapsed":45141,"user":{"displayName":"UDAYPRAKASH DASARI","userId":"16282147890996278182"}}},"execution_count":null,"outputs":[]},{"cell_type":"code","source":[],"metadata":{"id":"rPVG6910qMBh","executionInfo":{"status":"aborted","timestamp":1750496694875,"user_tz":-330,"elapsed":45143,"user":{"displayName":"UDAYPRAKASH DASARI","userId":"16282147890996278182"}}},"execution_count":null,"outputs":[]},{"cell_type":"code","source":[],"metadata":{"id":"-Aw5vEwbqL-k","executionInfo":{"status":"aborted","timestamp":1750496694876,"user_tz":-330,"elapsed":45143,"user":{"displayName":"UDAYPRAKASH DASARI","userId":"16282147890996278182"}}},"execution_count":null,"outputs":[]},{"cell_type":"code","source":[],"metadata":{"id":"esn6CXZBqL7z","executionInfo":{"status":"aborted","timestamp":1750496694878,"user_tz":-330,"elapsed":45145,"user":{"displayName":"UDAYPRAKASH DASARI","userId":"16282147890996278182"}}},"execution_count":null,"outputs":[]},{"cell_type":"code","source":["#"],"metadata":{"id":"FwQ1R2qSqL5A","executionInfo":{"status":"aborted","timestamp":1750496694880,"user_tz":-330,"elapsed":45147,"user":{"displayName":"UDAYPRAKASH DASARI","userId":"16282147890996278182"}}},"execution_count":null,"outputs":[]},{"cell_type":"markdown","source":["# sECOND"],"metadata":{"id":"h8I4c5clqOZF"}},{"cell_type":"code","source":["from pyspark.sql import SparkSession"],"metadata":{"id":"ufRTKztbqKx_","executionInfo":{"status":"aborted","timestamp":1750496694887,"user_tz":-330,"elapsed":45154,"user":{"displayName":"UDAYPRAKASH DASARI","userId":"16282147890996278182"}}},"execution_count":null,"outputs":[]},{"cell_type":"code","source":["sc = spark.sparkContext"],"metadata":{"id":"xgumhxeCqKvO","executionInfo":{"status":"aborted","timestamp":1750496694898,"user_tz":-330,"elapsed":45165,"user":{"displayName":"UDAYPRAKASH DASARI","userId":"16282147890996278182"}}},"execution_count":null,"outputs":[]},{"cell_type":"code","source":["data = [(\"Banana\",1000,\"USA\"), (\"Carrots\",1500,\"USA\"), (\"Beans\",1600,\"USA\"), \\\n","      (\"Orange\",2000,\"USA\"),(\"Orange\",2000,\"USA\"),(\"Banana\",400,\"China\"), \\\n","      (\"Carrots\",1200,\"China\"),(\"Beans\",1500,\"China\"),(\"Orange\",4000,\"China\"), \\\n","      (\"Banana\",2000,\"Canada\"),(\"Carrots\",2000,\"Canada\"),(\"Beans\",2000,\"Mexico\")]"],"metadata":{"id":"cAY1kxQsqKsz","executionInfo":{"status":"aborted","timestamp":1750496694904,"user_tz":-330,"elapsed":45170,"user":{"displayName":"UDAYPRAKASH DASARI","userId":"16282147890996278182"}}},"execution_count":null,"outputs":[]},{"cell_type":"code","source":["v1 = sc.parallelize(data)"],"metadata":{"id":"_P-giX08qKp8","executionInfo":{"status":"aborted","timestamp":1750496694911,"user_tz":-330,"elapsed":45177,"user":{"displayName":"UDAYPRAKASH DASARI","userId":"16282147890996278182"}}},"execution_count":null,"outputs":[]},{"cell_type":"code","source":["for i in v1.collect():\n","  print(i)"],"metadata":{"id":"Gr1vKMbyqKnZ","executionInfo":{"status":"aborted","timestamp":1750496694927,"user_tz":-330,"elapsed":45193,"user":{"displayName":"UDAYPRAKASH DASARI","userId":"16282147890996278182"}}},"execution_count":null,"outputs":[]},{"cell_type":"code","source":["columns = ['Product', 'Amount', 'Country']\n","df = spark.createDataFrame(data,schema=columns)"],"metadata":{"id":"oN2UnUatrNZb","executionInfo":{"status":"aborted","timestamp":1750496694928,"user_tz":-330,"elapsed":45194,"user":{"displayName":"UDAYPRAKASH DASARI","userId":"16282147890996278182"}}},"execution_count":null,"outputs":[]},{"cell_type":"code","source":["df.show()"],"metadata":{"id":"lYnDqXJprjhK","executionInfo":{"status":"aborted","timestamp":1750496694931,"user_tz":-330,"elapsed":45196,"user":{"displayName":"UDAYPRAKASH DASARI","userId":"16282147890996278182"}}},"execution_count":null,"outputs":[]},{"cell_type":"code","source":["pivot_df = df.groupBy(\"Product\").pivot(\"Country\").sum(\"Amount\")\n","pivot_df.show()"],"metadata":{"id":"TEeGj_JVrkjg","executionInfo":{"status":"aborted","timestamp":1750496694936,"user_tz":-330,"elapsed":45201,"user":{"displayName":"UDAYPRAKASH DASARI","userId":"16282147890996278182"}}},"execution_count":null,"outputs":[]},{"cell_type":"code","source":["unicexpr = \"stack(4, 'Canada', Canada, 'China', China, 'Mexico', Mexico, 'USA', USA)as (country,total)\""],"metadata":{"id":"K3tOZwn_r6v9","executionInfo":{"status":"aborted","timestamp":1750496694938,"user_tz":-330,"elapsed":45203,"user":{"displayName":"UDAYPRAKASH DASARI","userId":"16282147890996278182"}}},"execution_count":null,"outputs":[]},{"cell_type":"code","source":["unpivot_df = pivot_df.select('Product',expr(unicexpr)).where(\"total is not null\")"],"metadata":{"id":"6gMaZj8PsgLX","executionInfo":{"status":"aborted","timestamp":1750496694940,"user_tz":-330,"elapsed":45205,"user":{"displayName":"UDAYPRAKASH DASARI","userId":"16282147890996278182"}}},"execution_count":null,"outputs":[]},{"cell_type":"code","source":["unpivot_df.show()"],"metadata":{"id":"0b-U2WbfssRM","executionInfo":{"status":"aborted","timestamp":1750496694942,"user_tz":-330,"elapsed":45206,"user":{"displayName":"UDAYPRAKASH DASARI","userId":"16282147890996278182"}}},"execution_count":null,"outputs":[]},{"cell_type":"code","source":["data = [(\"2019-01-23\",1),(\"2022-02-28\",3),(\"2024-04-21\",6)]"],"metadata":{"id":"dcBg6FVPsyYV","executionInfo":{"status":"aborted","timestamp":1750496694944,"user_tz":-330,"elapsed":45208,"user":{"displayName":"UDAYPRAKASH DASARI","userId":"16282147890996278182"}}},"execution_count":null,"outputs":[]},{"cell_type":"code","source":["from pyspark.sql.functions import to_date"],"metadata":{"id":"ZOFgDAA0uMi9","executionInfo":{"status":"aborted","timestamp":1750496694946,"user_tz":-330,"elapsed":45210,"user":{"displayName":"UDAYPRAKASH DASARI","userId":"16282147890996278182"}}},"execution_count":null,"outputs":[]},{"cell_type":"code","source":["spark.createDataFrame(data).toDF(\"Date\",\"Increment\")\\\n","  .select(col('Date'), col(\"Increment\"),\\\n","  expr(\"add_months(to_date(Date, 'yyyy-MM-dd'),cast(increment as int))\").alias(\"inc_date\")).show()"],"metadata":{"id":"BaD-JaUFtaRz","executionInfo":{"status":"aborted","timestamp":1750496694951,"user_tz":-330,"elapsed":45215,"user":{"displayName":"UDAYPRAKASH DASARI","userId":"16282147890996278182"}}},"execution_count":null,"outputs":[]},{"cell_type":"code","source":["from pyspark.sql import SparkSession\n","from pyspark.sql.functions import approx_count_distinct,collect_list,\\\n","  collect_set,sum,avg,max,min,mean,stddev,count_distinct,count,\\\n","  first,last,kurtosis,skewness,stddev_samp,stddev_pop,sum_Distinct,variance,var_samp,var_pop"],"metadata":{"id":"krY-Hk0Exdhf","executionInfo":{"status":"aborted","timestamp":1750496695024,"user_tz":-330,"elapsed":45288,"user":{"displayName":"UDAYPRAKASH DASARI","userId":"16282147890996278182"}}},"execution_count":null,"outputs":[]},{"cell_type":"code","source":[],"metadata":{"id":"BPnun3EGzW65","executionInfo":{"status":"aborted","timestamp":1750496695032,"user_tz":-330,"elapsed":45295,"user":{"displayName":"UDAYPRAKASH DASARI","userId":"16282147890996278182"}}},"execution_count":null,"outputs":[]}],"metadata":{"colab":{"provenance":[],"mount_file_id":"1KiohScwXbksLQDsszqLh4fh0L4hZBhoN","authorship_tag":"ABX9TyOvmaT5gGSkXN27f3r3Yw9j"},"kernelspec":{"display_name":"Python 3","name":"python3"},"language_info":{"name":"python"}},"nbformat":4,"nbformat_minor":0}